<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pure Freeze Page (Playwright-friendly)</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; line-height: 1.4; }
    .card { max-width: 720px; margin: 0 auto; padding: 24px; border: 1px solid rgba(0,0,0,.12); border-radius: 16px; box-shadow: 0 6px 24px rgba(0,0,0,.07); }
    h1 { margin: 0 0 12px; font-size: 1.5rem; }
    p { margin: 8px 0 16px; opacity: .9; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; }
    /* High-contrast, readable buttons */
    button { padding: 10px 14px; border-radius: 12px; border: 1px solid rgba(0,0,0,.4); background: #111; color: #fff; cursor: pointer; font-weight: 700; letter-spacing: .2px; }
    button:hover { filter: brightness(1.1); }
    input[type="number"], input[type="text"] { width: 160px; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(0,0,0,.35); background: #fff; color: #111; }
    .hint { font-size: .95rem; opacity: .85; }
    code { padding: 2px 6px; border-radius: 6px; background: rgba(0,0,0,.07); }
    label { font-weight: 600; }
  </style>
</head>
<body>
  <div class="card">
    <h1 id="page-title">Pure Freeze Demo</h1>
    <p class="hint">Click a button to intentionally block the main thread. No handling/recovery is included.<br>
      URL params:
      <code>?ms=5000</code> (sets duration),
      <code>&autofreeze=1</code> (freeze on load),
      <code>&delay=100</code> (ms to wait before freezing so Playwright Recorder can capture the action).
    </p>

    <div class="row" style="margin:12px 0 8px">
      <!-- Stable selectors for Playwright -->
      <button id="freeze-3" name="freeze-3" data-testid="freeze-3" aria-label="Freeze 3 seconds" role="button">Freeze 3s</button>
      <button id="freeze-10" name="freeze-10" data-testid="freeze-10" aria-label="Freeze 10 seconds" role="button">Freeze 10s</button>
      <label for="custom-ms">Custom (ms):</label>
      <input id="custom-ms" name="custom-ms" data-testid="custom-ms" type="number" min="0" step="100" value="5000" placeholder="e.g. 7500" />
      <button id="freeze-custom" name="freeze-custom" data-testid="freeze-custom" aria-label="Freeze custom milliseconds" role="button">Freeze (custom)</button>
    </div>

    <p class="hint">Examples: <code>https://your-host/freezer.html?ms=7500</code> or <code>... ?ms=7500&autofreeze=1&delay=250</code>.</p>
  </div>

  <script>
    // Busy-wait main-thread freeze (no logging/handlers)
    function freeze(ms) {
      const end = performance.now() + ms;
      while (performance.now() < end) {}
    }

    // Parse URL params
    const params = new URLSearchParams(location.search);
    function getMsFromURL() {
      const raw = params.get('ms') ?? params.get('time') ?? params.get('t') ?? params.get('duration');
      const n = raw == null ? NaN : Number(raw);
      if (Number.isFinite(n) && n >= 0) return Math.min(n, 120000); // cap 2min
      return null;
    }
    function getDelayFromURL() {
      const raw = params.get('delay');
      const n = raw == null ? NaN : Number(raw);
      if (Number.isFinite(n) && n >= 0) return Math.min(n, 5000); // cap 5s to keep things sane
      return 100; // default small delay so Recorder reliably captures the click/type before blocking
    }

    // Utility to trigger freeze after a small delay (so PW Recorder logs the action)
    function scheduleFreeze(ms) {
      const delay = getDelayFromURL();
      // Use setTimeout to allow the click/type event to flush and Recorder to log.
      setTimeout(() => freeze(ms), delay);
    }

    // Wire up UI â€” buttons only schedule freeze (no extra handling)
    const $ms = document.getElementById('custom-ms');
    document.getElementById('freeze-3').addEventListener('click', () => scheduleFreeze(3000));
    document.getElementById('freeze-10').addEventListener('click', () => scheduleFreeze(10000));
    document.getElementById('freeze-custom').addEventListener('click', () => {
      const val = parseInt($ms.value, 10) || 0;
      const ms = Math.max(0, Math.min(val, 120000));
      scheduleFreeze(ms);
    });

    // Initialize from URL and optionally auto-freeze
    const urlMs = getMsFromURL();
    if (urlMs != null) $ms.value = String(urlMs);
    const shouldAuto = params.has('autofreeze');
    if (urlMs != null && shouldAuto) {
      // give PW Recorder a moment to attach before blocking
      scheduleFreeze(urlMs);
    }
  </script>
</body>
</html>