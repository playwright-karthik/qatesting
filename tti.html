<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTI Simulation Page</title>
    <script>
        let startTime;
        let clockInterval;

        function startClock() {
            startTime = performance.now();
            document.getElementById('clock').innerText = 'Clock: 0 ms';
            clockInterval = setInterval(() => {
                document.getElementById('clock').innerText = `Clock: ${Math.round(performance.now() - startTime)} ms`;
            }, 50);
        }

        function stopClock() {
            clearInterval(clockInterval);
        }

        function simulateWork(duration) {
            const start = performance.now();
            while (performance.now() - start < duration) {
                // Simulate long task
            }
        }

        function simulateNetworkRequest() {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve('Network request completed');
                }, Math.random() * 2000 + 1000); // Random delay between 1-3 seconds
            });
        }

        async function calculateTTI() {
            startClock(); // Start clock when calculation begins
            simulateWork(200);
            await simulateNetworkRequest();
            simulateWork(300);
            await simulateNetworkRequest();
            simulateWork(150);
            const tti = Math.round(performance.now() - startTime);
            document.getElementById('tti-value').innerText = `TTI: ${tti} ms`;
            stopClock(); // Stop clock when TTI is displayed
        }

        function handleInteraction(event) {
            document.getElementById('extra-delay-msg').innerText = `Clicked: ${event.target.innerText}`;
            calculateTTI(); // Recalculate TTI on interaction
        }

        window.onload = () => {
            calculateTTI(); // Calculate TTI on page load
        };
    </script>
</head>
<body>
    <h1>TTI Simulation Page</h1>
    <p id="tti-value">Calculating TTI...</p>
    <p id="clock">Clock: 0 ms</p>
    <p>Hosting URL: <a href="https://playwright-karthik.github.io/qatesting/tti.html" target="_blank">https://playwright-karthik.github.io/qatesting/tti.html</a></p>
    <button onclick="handleInteraction(event)">Recalculate TTI</button>
    <button onclick="handleInteraction(event)">Simulate Heavy Task</button>
    <button onclick="handleInteraction(event)">Trigger Network Delay</button>
    <p id="extra-delay-msg"></p>
</body>
</html>
